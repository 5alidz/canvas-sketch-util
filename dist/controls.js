/**
 * Highly experimental! Subject to removal.
 */

var GUI = require('dat.gui').GUI;
var defined = require('defined');
var parseColor = require('parse-color');
var ref = require('events');
var EventEmitter = ref.EventEmitter;

var gui = new GUI();
var fileName = process.env.SKETCH_ENTRY;
var LOCAL_STORAGE_KEY = (fileName || __filename) + ":gui";
var parent = document.querySelector('.dg.ac');

var store = {};
var currentControls = [];

if (parent) {
  var child = document.querySelector('.dg.main');
  if (child) { child.style.margin = '0'; }
  Object.assign(parent.style, {
    width: '100%',
    height: '100%',
    display: 'flex',
    flexDirection: 'row-reverse'
  });
}

function defaultStep (n, min, max) {
  if ( min === void 0 ) min = -Infinity;
  if ( max === void 0 ) max = Infinity;

  if (typeof n !== 'undefined') {
    if (!isFinite(n)) {
      throw new Error('Cannot use a { step } of Infinity');
    }
    return n;
  }
  if (isFinite(min) && isFinite(max)) {
    var difference = Math.abs(max - min);
    if (difference !== 0) { return difference * 0.01; }
  }
  return 0.01;
}

function Color (value, options) {
  if ( options === void 0 ) options = {};

  if (typeof options === 'string') {
    options = { mode: options };
  }
  var color = parseColor(value);
  var mode = options.mode || 'hex';
  if (!color || !color[mode]) {
    throw new Error(("Could not parse color " + value));
  }
  return {
    isControl: true,
    value: color[mode],
    type: 'color',
    attach: function (target, key, parent) { return parent.addColor(target, key); },
    options: Object.assign({}, options, { mode: mode })
  };
}

function ColorParsed (value, options) {
  if ( options === void 0 ) options = {};

  return {
    isControl: true,
    value: value,
    type: 'color',
    attach: function (target, key, parent) { return parent.addColor(target, key); },
    options: options
  };
}

function Slider (value, options) {
  if ( options === void 0 ) options = {};

  var min, max, step;
  if (typeof arguments[1] === 'number' || arguments.length > 2) {
    // shorthand: Slider(300, 0, 1, 0.5)
    min = arguments[1];
    max = arguments[2];
    step = arguments[3];
    options = {};
  } else {
    // longhand: Slider(300, { label: 'foo', range: [ 0, 1 ] })
    if (options.range) { throw new Error('{ range } deprecated, use min/max'); }
    min = options.min;
    max = options.max;
    step = options.step;
  }

  // Manage defaults
  min = defined(min, 0);
  max = defined(max, 1);

  if (!isFinite(min) || !isFinite(max)) {
    throw new Error('Cannot use a { min } or { max } of Infinity');
  }

  step = defaultStep(step, min, max);

  return {
    isControl: true,
    value: value,
    type: 'slider',
    attach: function (target, key, parent) { return parent.add(target, key, min, max, step); },
    options: Object.assign({}, options, { min: min, max: max, step: step })
  };
}

function Select (value, options) {
  if ( options === void 0 ) options = {};

  return {
    isControl: true,
    value: value,
    type: 'select',
    attach: function (target, key, parent) { return parent.add(target, key, options); },
    options: options
  };
}

function Checkbox (value, options) {
  if ( options === void 0 ) options = {};

  return {
    isControl: true,
    value: value,
    type: 'checkbox',
    attach: function (target, key, parent) { return parent.add(target, key); },
    options: options
  };
}

function Button (value, options) {
  if ( options === void 0 ) options = {};

  return {
    isControl: true,
    value: value,
    type: 'button',
    attach: function (target, key, parent) { return parent.add(target, key); },
    options: options
  };
}

function StringInput (value, options) {
  if ( options === void 0 ) options = {};

  return {
    isControl: true,
    value: value,
    type: 'button',
    attach: function (target, key, parent) { return parent.add(target, key); },
    options: options
  };
}

function NumberInput (value, options) {
  var hasArgs = typeof arguments[1] === 'number' || arguments.length > 2;
  var args = hasArgs ? Array.from(arguments).slice(1) : [];
  options = options || {};
  if (typeof value !== 'number') { value = Number(value) || 0; }
  return {
    isControl: true,
    value: value,
    type: 'number',
    attach: function (target, key, parent) {
      return parent.add(target, key);
    },
    options: options
  };
}

function Value (value) {
  return {
    isRawValue: true,
    type: 'value',
    value: value
  };
}

function detect (value) {
  if (typeof value === 'string') {
    var result = parseColor(value);
    if (!result.hex) { return StringInput(value); }
    return ColorParsed(result.hex);
  } else if (typeof value === 'boolean') {
    return Checkbox(value);
  } else if (typeof value === 'function') {
    return Button(value);
  } else if (typeof value === 'number') {
    return NumberInput(value);
  } else {
    // No type detected, fall back to non-gui property
    return null;
  }
}

function isValueProp (value) {
  return value && value.isRawValue;
}

function clampNumber (value, options) {
  if (typeof value === 'number' && isFinite(value)) {
    if (typeof options.min !== 'undefined') { value = Math.max(value, options.min); }
    if (typeof options.max !== 'undefined') { value = Math.min(value, options.max); }
  }
  return value;
}

function createControls (opt, cb, label, parent) {
  if ( opt === void 0 ) opt = {};

  var controls = new EventEmitter();
  var obj = { controls: controls };
  var reserved = [ 'controls' ];
  var guiPath = getGUIPath(parent);

  var triggerChange = function (ev) {
    controls.emit('change', ev);
  };

  if ('controls' in opt) {
    throw new Error('The { controls } key is reserved for GUI reasons, please choose another key');
  }

  // Sync store to new state
  readLocalStorage();

  var proxy = new Proxy(obj, {
    set: function set (target, key, value) {
      if (reserved.includes(key)) {
        throw new Error(("The { " + key + " } property is reserved for GUI controls, please choose another key name"));
      }
      if (isValueProp(value)) {
        target[key] = value.value;
        return true;
      }

      if (!(key in target)) {
        // GUI being added
        var control;
        if (value && value.isControl) {
          control = value;
        } else {
          control = detect(value);
        }

        if (control) {
          var storageKey = [ guiPath, key ].join('.');
          var currentValue = getLocalStorage(control, storageKey);
          var defaultValue = control.value;
          console.log(storageKey, defaultValue, currentValue);
          target[key] = clampNumber(defined(currentValue, defaultValue), control.options);
          putLocalStorage(control, storageKey, target[key]);
          var guiControl = control.attach(target, key, parent);
          if (guiControl.name && control.options.label) {
            guiControl.name(control.options.label);
          }
          controls[key] = guiControl;
          guiControl.reset = function () {
            proxy[key] = defaultValue;
          };
          guiControl.onChange(function (ev) {
            putLocalStorage(control, storageKey, target[key]);
            triggerChange(ev);
          });
          currentControls.push(guiControl);
        } else {
          // Not auto-detected, maybe a regular object or
          // something that shouldn't be added to GUI
          target[key] = value;

          // also add to controls if it's an object, to make a tree
          if (typeof value === 'object' && value && value.controls) {
            if (typeof value.controls.on !== 'function') {
              throw new Error('The { controls } field is a reserved word for the GUI, it should point to a UI control mapping');
            }
            controls[key] = value.controls;
            value.controls
              .on('change', triggerChange);
          }
        }
      } else if (value && value.isControl) {
        throw new Error('Re-assigning values to a new control is not yet supported');
      } else {
        // GUI being manually mutated
        target[key] = value;
        if (key in controls) {
          controls[key].updateDisplay();
        }
      }
      return true;
    },
    get: function get (target, key) {
      if (key === 'controls') { return controls; }
      var result = target[key];
      return result;
    }
  });
  Object.assign(proxy, opt);
  if (typeof cb === 'function') {
    var update = function () { return cb(obj); };
    controls.on('change', update);
  }
  return proxy;
}

function getGUIPath (gui) {
  var name = gui.name || 'root';
  while (gui) {
    gui = gui.parent;
    if (gui) { name = (gui.name || 'root') + "." + name; }
  }
  return name;
}

function putLocalStorage (currentControl, key, value) {
  if (JSON.stringify(value)) {
    store[key] = { value: value, type: currentControl.type, defaultValue: currentControl.value };
    writeLocalStorage();
  }
}

function getLocalStorage (currentControl, key) {
  if (key in store) {
    var stored = store[key];
    if (!stored) { return undefined; }
    if (currentControl.type !== stored.type) { return undefined; }
    if (currentControl.value !== stored.defaultValue) { return undefined; }
    // console.log('CHECK CHECK', key, currentControl.value, stored.defaultValue)
    return stored.value;
  }
  return undefined;
}

function readLocalStorage () {
  // Parse new store, usually just happens at startup
  try {
    var str = window.localStorage.getItem(LOCAL_STORAGE_KEY);
    if (str == null) {
      // No storage yet identified, no need to keep anything around yet
      clearStorage();
      return;
    }
    var newStore = JSON.parse(str);
    store = newStore; // assign new store
  } catch (err) {
    console.warn(("The localStorage at " + LOCAL_STORAGE_KEY + " could not be parsed due to a JSON error."));
    console.warn(err);
    // Clear the error so it doesn't keep polluting logs
    clearStorage();
  }
}

function clearStorage () {
  window.localStorage.removeItem(LOCAL_STORAGE_KEY);
  store = {};
}

function reset () {
  clearStorage();
  currentControls.forEach(function (control) {
    control.reset();
  });
}

function writeLocalStorage () {
  var str = JSON.stringify(store);
  if (str == null) {
    console.warn('The storage could not be stringified as JSON, skipping localStorage');
    return;
  }
  window.localStorage.setItem(LOCAL_STORAGE_KEY, str);
}

function Controls (opts, cb) {
  if ( opts === void 0 ) opts = {};

  return createControls(opts, cb, 'root', gui);
}

function Folder (label, opts, cb) {
  if ( opts === void 0 ) opts = {};

  if (!label) { throw new Error('Must specify a label for Folder()'); }
  var folder = gui.addFolder(label);
  folder.open();
  return createControls(opts, cb, label, folder);
}

Object.assign(Controls, {
  parent: parent,
  number: NumberInput,
  string: StringInput,
  slider: Slider,
  select: Select,
  checkbox: Checkbox,
  button: Button,
  folder: Folder,
  color: Color,
  value: Value,
  clearStorage: clearStorage,
  reset: reset,

  // Deprecated
  Slider: Slider,
  Number: Number,
  Select: Select,
  Button: Button,
  Checkbox: Checkbox,
  Folder: Folder,
  Color: Color,
  Value: Value
});

module.exports = Controls;

//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY29udHJvbHMuanMiLCJzb3VyY2VzIjpbIi4uL3NyYy9jb250cm9scy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIEhpZ2hseSBleHBlcmltZW50YWwhIFN1YmplY3QgdG8gcmVtb3ZhbC5cbiAqL1xuXG5jb25zdCBHVUkgPSByZXF1aXJlKCdkYXQuZ3VpJykuR1VJO1xuY29uc3QgZGVmaW5lZCA9IHJlcXVpcmUoJ2RlZmluZWQnKTtcbmNvbnN0IHBhcnNlQ29sb3IgPSByZXF1aXJlKCdwYXJzZS1jb2xvcicpO1xuY29uc3QgeyBFdmVudEVtaXR0ZXIgfSA9IHJlcXVpcmUoJ2V2ZW50cycpO1xuXG5jb25zdCBndWkgPSBuZXcgR1VJKCk7XG5jb25zdCBmaWxlTmFtZSA9IHByb2Nlc3MuZW52LlNLRVRDSF9FTlRSWTtcbmNvbnN0IExPQ0FMX1NUT1JBR0VfS0VZID0gYCR7ZmlsZU5hbWUgfHwgX19maWxlbmFtZX06Z3VpYDtcbmNvbnN0IHBhcmVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZy5hYycpO1xuXG5sZXQgc3RvcmUgPSB7fTtcbmxldCBjdXJyZW50Q29udHJvbHMgPSBbXTtcblxuaWYgKHBhcmVudCkge1xuICBjb25zdCBjaGlsZCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5kZy5tYWluJyk7XG4gIGlmIChjaGlsZCkgY2hpbGQuc3R5bGUubWFyZ2luID0gJzAnO1xuICBPYmplY3QuYXNzaWduKHBhcmVudC5zdHlsZSwge1xuICAgIHdpZHRoOiAnMTAwJScsXG4gICAgaGVpZ2h0OiAnMTAwJScsXG4gICAgZGlzcGxheTogJ2ZsZXgnLFxuICAgIGZsZXhEaXJlY3Rpb246ICdyb3ctcmV2ZXJzZSdcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGRlZmF1bHRTdGVwIChuLCBtaW4gPSAtSW5maW5pdHksIG1heCA9IEluZmluaXR5KSB7XG4gIGlmICh0eXBlb2YgbiAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICBpZiAoIWlzRmluaXRlKG4pKSB7XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ0Nhbm5vdCB1c2UgYSB7IHN0ZXAgfSBvZiBJbmZpbml0eScpO1xuICAgIH1cbiAgICByZXR1cm4gbjtcbiAgfVxuICBpZiAoaXNGaW5pdGUobWluKSAmJiBpc0Zpbml0ZShtYXgpKSB7XG4gICAgY29uc3QgZGlmZmVyZW5jZSA9IE1hdGguYWJzKG1heCAtIG1pbik7XG4gICAgaWYgKGRpZmZlcmVuY2UgIT09IDApIHJldHVybiBkaWZmZXJlbmNlICogMC4wMTtcbiAgfVxuICByZXR1cm4gMC4wMTtcbn1cblxuZnVuY3Rpb24gQ29sb3IgKHZhbHVlLCBvcHRpb25zID0ge30pIHtcbiAgaWYgKHR5cGVvZiBvcHRpb25zID09PSAnc3RyaW5nJykge1xuICAgIG9wdGlvbnMgPSB7IG1vZGU6IG9wdGlvbnMgfTtcbiAgfVxuICBjb25zdCBjb2xvciA9IHBhcnNlQ29sb3IodmFsdWUpO1xuICBjb25zdCBtb2RlID0gb3B0aW9ucy5tb2RlIHx8ICdoZXgnO1xuICBpZiAoIWNvbG9yIHx8ICFjb2xvclttb2RlXSkge1xuICAgIHRocm93IG5ldyBFcnJvcihgQ291bGQgbm90IHBhcnNlIGNvbG9yICR7dmFsdWV9YCk7XG4gIH1cbiAgcmV0dXJuIHtcbiAgICBpc0NvbnRyb2w6IHRydWUsXG4gICAgdmFsdWU6IGNvbG9yW21vZGVdLFxuICAgIHR5cGU6ICdjb2xvcicsXG4gICAgYXR0YWNoOiAodGFyZ2V0LCBrZXksIHBhcmVudCkgPT4gcGFyZW50LmFkZENvbG9yKHRhcmdldCwga2V5KSxcbiAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7IG1vZGUgfSlcbiAgfTtcbn1cblxuZnVuY3Rpb24gQ29sb3JQYXJzZWQgKHZhbHVlLCBvcHRpb25zID0ge30pIHtcbiAgcmV0dXJuIHtcbiAgICBpc0NvbnRyb2w6IHRydWUsXG4gICAgdmFsdWUsXG4gICAgdHlwZTogJ2NvbG9yJyxcbiAgICBhdHRhY2g6ICh0YXJnZXQsIGtleSwgcGFyZW50KSA9PiBwYXJlbnQuYWRkQ29sb3IodGFyZ2V0LCBrZXkpLFxuICAgIG9wdGlvbnNcbiAgfTtcbn1cblxuZnVuY3Rpb24gU2xpZGVyICh2YWx1ZSwgb3B0aW9ucyA9IHt9KSB7XG4gIGxldCBtaW4sIG1heCwgc3RlcDtcbiAgaWYgKHR5cGVvZiBhcmd1bWVudHNbMV0gPT09ICdudW1iZXInIHx8IGFyZ3VtZW50cy5sZW5ndGggPiAyKSB7XG4gICAgLy8gc2hvcnRoYW5kOiBTbGlkZXIoMzAwLCAwLCAxLCAwLjUpXG4gICAgbWluID0gYXJndW1lbnRzWzFdO1xuICAgIG1heCA9IGFyZ3VtZW50c1syXTtcbiAgICBzdGVwID0gYXJndW1lbnRzWzNdO1xuICAgIG9wdGlvbnMgPSB7fTtcbiAgfSBlbHNlIHtcbiAgICAvLyBsb25naGFuZDogU2xpZGVyKDMwMCwgeyBsYWJlbDogJ2ZvbycsIHJhbmdlOiBbIDAsIDEgXSB9KVxuICAgIGlmIChvcHRpb25zLnJhbmdlKSB0aHJvdyBuZXcgRXJyb3IoJ3sgcmFuZ2UgfSBkZXByZWNhdGVkLCB1c2UgbWluL21heCcpO1xuICAgIG1pbiA9IG9wdGlvbnMubWluO1xuICAgIG1heCA9IG9wdGlvbnMubWF4O1xuICAgIHN0ZXAgPSBvcHRpb25zLnN0ZXA7XG4gIH1cblxuICAvLyBNYW5hZ2UgZGVmYXVsdHNcbiAgbWluID0gZGVmaW5lZChtaW4sIDApO1xuICBtYXggPSBkZWZpbmVkKG1heCwgMSk7XG5cbiAgaWYgKCFpc0Zpbml0ZShtaW4pIHx8ICFpc0Zpbml0ZShtYXgpKSB7XG4gICAgdGhyb3cgbmV3IEVycm9yKCdDYW5ub3QgdXNlIGEgeyBtaW4gfSBvciB7IG1heCB9IG9mIEluZmluaXR5Jyk7XG4gIH1cblxuICBzdGVwID0gZGVmYXVsdFN0ZXAoc3RlcCwgbWluLCBtYXgpO1xuXG4gIHJldHVybiB7XG4gICAgaXNDb250cm9sOiB0cnVlLFxuICAgIHZhbHVlLFxuICAgIHR5cGU6ICdzbGlkZXInLFxuICAgIGF0dGFjaDogKHRhcmdldCwga2V5LCBwYXJlbnQpID0+IHBhcmVudC5hZGQodGFyZ2V0LCBrZXksIG1pbiwgbWF4LCBzdGVwKSxcbiAgICBvcHRpb25zOiBPYmplY3QuYXNzaWduKHt9LCBvcHRpb25zLCB7IG1pbiwgbWF4LCBzdGVwIH0pXG4gIH07XG59XG5cbmZ1bmN0aW9uIFNlbGVjdCAodmFsdWUsIG9wdGlvbnMgPSB7fSkge1xuICByZXR1cm4ge1xuICAgIGlzQ29udHJvbDogdHJ1ZSxcbiAgICB2YWx1ZSxcbiAgICB0eXBlOiAnc2VsZWN0JyxcbiAgICBhdHRhY2g6ICh0YXJnZXQsIGtleSwgcGFyZW50KSA9PiBwYXJlbnQuYWRkKHRhcmdldCwga2V5LCBvcHRpb25zKSxcbiAgICBvcHRpb25zXG4gIH07XG59XG5cbmZ1bmN0aW9uIENoZWNrYm94ICh2YWx1ZSwgb3B0aW9ucyA9IHt9KSB7XG4gIHJldHVybiB7XG4gICAgaXNDb250cm9sOiB0cnVlLFxuICAgIHZhbHVlLFxuICAgIHR5cGU6ICdjaGVja2JveCcsXG4gICAgYXR0YWNoOiAodGFyZ2V0LCBrZXksIHBhcmVudCkgPT4gcGFyZW50LmFkZCh0YXJnZXQsIGtleSksXG4gICAgb3B0aW9uc1xuICB9O1xufVxuXG5mdW5jdGlvbiBCdXR0b24gKHZhbHVlLCBvcHRpb25zID0ge30pIHtcbiAgcmV0dXJuIHtcbiAgICBpc0NvbnRyb2w6IHRydWUsXG4gICAgdmFsdWUsXG4gICAgdHlwZTogJ2J1dHRvbicsXG4gICAgYXR0YWNoOiAodGFyZ2V0LCBrZXksIHBhcmVudCkgPT4gcGFyZW50LmFkZCh0YXJnZXQsIGtleSksXG4gICAgb3B0aW9uc1xuICB9O1xufVxuXG5mdW5jdGlvbiBTdHJpbmdJbnB1dCAodmFsdWUsIG9wdGlvbnMgPSB7fSkge1xuICByZXR1cm4ge1xuICAgIGlzQ29udHJvbDogdHJ1ZSxcbiAgICB2YWx1ZSxcbiAgICB0eXBlOiAnYnV0dG9uJyxcbiAgICBhdHRhY2g6ICh0YXJnZXQsIGtleSwgcGFyZW50KSA9PiBwYXJlbnQuYWRkKHRhcmdldCwga2V5KSxcbiAgICBvcHRpb25zXG4gIH07XG59XG5cbmZ1bmN0aW9uIE51bWJlcklucHV0ICh2YWx1ZSwgb3B0aW9ucykge1xuICBjb25zdCBoYXNBcmdzID0gdHlwZW9mIGFyZ3VtZW50c1sxXSA9PT0gJ251bWJlcicgfHwgYXJndW1lbnRzLmxlbmd0aCA+IDI7XG4gIGNvbnN0IGFyZ3MgPSBoYXNBcmdzID8gQXJyYXkuZnJvbShhcmd1bWVudHMpLnNsaWNlKDEpIDogW107XG4gIG9wdGlvbnMgPSBvcHRpb25zIHx8IHt9O1xuICBpZiAodHlwZW9mIHZhbHVlICE9PSAnbnVtYmVyJykgdmFsdWUgPSBOdW1iZXIodmFsdWUpIHx8IDA7XG4gIHJldHVybiB7XG4gICAgaXNDb250cm9sOiB0cnVlLFxuICAgIHZhbHVlLFxuICAgIHR5cGU6ICdudW1iZXInLFxuICAgIGF0dGFjaDogKHRhcmdldCwga2V5LCBwYXJlbnQpID0+IHtcbiAgICAgIHJldHVybiBwYXJlbnQuYWRkKHRhcmdldCwga2V5KTtcbiAgICB9LFxuICAgIG9wdGlvbnNcbiAgfTtcbn1cblxuZnVuY3Rpb24gVmFsdWUgKHZhbHVlKSB7XG4gIHJldHVybiB7XG4gICAgaXNSYXdWYWx1ZTogdHJ1ZSxcbiAgICB0eXBlOiAndmFsdWUnLFxuICAgIHZhbHVlXG4gIH07XG59XG5cbmZ1bmN0aW9uIGRldGVjdCAodmFsdWUpIHtcbiAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ3N0cmluZycpIHtcbiAgICBjb25zdCByZXN1bHQgPSBwYXJzZUNvbG9yKHZhbHVlKTtcbiAgICBpZiAoIXJlc3VsdC5oZXgpIHJldHVybiBTdHJpbmdJbnB1dCh2YWx1ZSk7XG4gICAgcmV0dXJuIENvbG9yUGFyc2VkKHJlc3VsdC5oZXgpO1xuICB9IGVsc2UgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Jvb2xlYW4nKSB7XG4gICAgcmV0dXJuIENoZWNrYm94KHZhbHVlKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdmdW5jdGlvbicpIHtcbiAgICByZXR1cm4gQnV0dG9uKHZhbHVlKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInKSB7XG4gICAgcmV0dXJuIE51bWJlcklucHV0KHZhbHVlKTtcbiAgfSBlbHNlIHtcbiAgICAvLyBObyB0eXBlIGRldGVjdGVkLCBmYWxsIGJhY2sgdG8gbm9uLWd1aSBwcm9wZXJ0eVxuICAgIHJldHVybiBudWxsO1xuICB9XG59XG5cbmZ1bmN0aW9uIGlzVmFsdWVQcm9wICh2YWx1ZSkge1xuICByZXR1cm4gdmFsdWUgJiYgdmFsdWUuaXNSYXdWYWx1ZTtcbn1cblxuZnVuY3Rpb24gY2xhbXBOdW1iZXIgKHZhbHVlLCBvcHRpb25zKSB7XG4gIGlmICh0eXBlb2YgdmFsdWUgPT09ICdudW1iZXInICYmIGlzRmluaXRlKHZhbHVlKSkge1xuICAgIGlmICh0eXBlb2Ygb3B0aW9ucy5taW4gIT09ICd1bmRlZmluZWQnKSB2YWx1ZSA9IE1hdGgubWF4KHZhbHVlLCBvcHRpb25zLm1pbik7XG4gICAgaWYgKHR5cGVvZiBvcHRpb25zLm1heCAhPT0gJ3VuZGVmaW5lZCcpIHZhbHVlID0gTWF0aC5taW4odmFsdWUsIG9wdGlvbnMubWF4KTtcbiAgfVxuICByZXR1cm4gdmFsdWU7XG59XG5cbmZ1bmN0aW9uIGNyZWF0ZUNvbnRyb2xzIChvcHQgPSB7fSwgY2IsIGxhYmVsLCBwYXJlbnQpIHtcbiAgY29uc3QgY29udHJvbHMgPSBuZXcgRXZlbnRFbWl0dGVyKCk7XG4gIGNvbnN0IG9iaiA9IHsgY29udHJvbHMgfTtcbiAgY29uc3QgcmVzZXJ2ZWQgPSBbICdjb250cm9scycgXTtcbiAgY29uc3QgZ3VpUGF0aCA9IGdldEdVSVBhdGgocGFyZW50KTtcblxuICBjb25zdCB0cmlnZ2VyQ2hhbmdlID0gKGV2KSA9PiB7XG4gICAgY29udHJvbHMuZW1pdCgnY2hhbmdlJywgZXYpO1xuICB9O1xuXG4gIGlmICgnY29udHJvbHMnIGluIG9wdCkge1xuICAgIHRocm93IG5ldyBFcnJvcignVGhlIHsgY29udHJvbHMgfSBrZXkgaXMgcmVzZXJ2ZWQgZm9yIEdVSSByZWFzb25zLCBwbGVhc2UgY2hvb3NlIGFub3RoZXIga2V5Jyk7XG4gIH1cblxuICAvLyBTeW5jIHN0b3JlIHRvIG5ldyBzdGF0ZVxuICByZWFkTG9jYWxTdG9yYWdlKCk7XG5cbiAgY29uc3QgcHJveHkgPSBuZXcgUHJveHkob2JqLCB7XG4gICAgc2V0ICh0YXJnZXQsIGtleSwgdmFsdWUpIHtcbiAgICAgIGlmIChyZXNlcnZlZC5pbmNsdWRlcyhrZXkpKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgVGhlIHsgJHtrZXl9IH0gcHJvcGVydHkgaXMgcmVzZXJ2ZWQgZm9yIEdVSSBjb250cm9scywgcGxlYXNlIGNob29zZSBhbm90aGVyIGtleSBuYW1lYCk7XG4gICAgICB9XG4gICAgICBpZiAoaXNWYWx1ZVByb3AodmFsdWUpKSB7XG4gICAgICAgIHRhcmdldFtrZXldID0gdmFsdWUudmFsdWU7XG4gICAgICAgIHJldHVybiB0cnVlO1xuICAgICAgfVxuXG4gICAgICBpZiAoIShrZXkgaW4gdGFyZ2V0KSkge1xuICAgICAgICAvLyBHVUkgYmVpbmcgYWRkZWRcbiAgICAgICAgbGV0IGNvbnRyb2w7XG4gICAgICAgIGlmICh2YWx1ZSAmJiB2YWx1ZS5pc0NvbnRyb2wpIHtcbiAgICAgICAgICBjb250cm9sID0gdmFsdWU7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgY29udHJvbCA9IGRldGVjdCh2YWx1ZSk7XG4gICAgICAgIH1cblxuICAgICAgICBpZiAoY29udHJvbCkge1xuICAgICAgICAgIGNvbnN0IHN0b3JhZ2VLZXkgPSBbIGd1aVBhdGgsIGtleSBdLmpvaW4oJy4nKTtcbiAgICAgICAgICBjb25zdCBjdXJyZW50VmFsdWUgPSBnZXRMb2NhbFN0b3JhZ2UoY29udHJvbCwgc3RvcmFnZUtleSk7XG4gICAgICAgICAgY29uc3QgZGVmYXVsdFZhbHVlID0gY29udHJvbC52YWx1ZTtcbiAgICAgICAgICBjb25zb2xlLmxvZyhzdG9yYWdlS2V5LCBkZWZhdWx0VmFsdWUsIGN1cnJlbnRWYWx1ZSk7XG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSBjbGFtcE51bWJlcihkZWZpbmVkKGN1cnJlbnRWYWx1ZSwgZGVmYXVsdFZhbHVlKSwgY29udHJvbC5vcHRpb25zKTtcbiAgICAgICAgICBwdXRMb2NhbFN0b3JhZ2UoY29udHJvbCwgc3RvcmFnZUtleSwgdGFyZ2V0W2tleV0pO1xuICAgICAgICAgIGNvbnN0IGd1aUNvbnRyb2wgPSBjb250cm9sLmF0dGFjaCh0YXJnZXQsIGtleSwgcGFyZW50KTtcbiAgICAgICAgICBpZiAoZ3VpQ29udHJvbC5uYW1lICYmIGNvbnRyb2wub3B0aW9ucy5sYWJlbCkge1xuICAgICAgICAgICAgZ3VpQ29udHJvbC5uYW1lKGNvbnRyb2wub3B0aW9ucy5sYWJlbCk7XG4gICAgICAgICAgfVxuICAgICAgICAgIGNvbnRyb2xzW2tleV0gPSBndWlDb250cm9sO1xuICAgICAgICAgIGd1aUNvbnRyb2wucmVzZXQgPSAoKSA9PiB7XG4gICAgICAgICAgICBwcm94eVtrZXldID0gZGVmYXVsdFZhbHVlO1xuICAgICAgICAgIH07XG4gICAgICAgICAgZ3VpQ29udHJvbC5vbkNoYW5nZShldiA9PiB7XG4gICAgICAgICAgICBwdXRMb2NhbFN0b3JhZ2UoY29udHJvbCwgc3RvcmFnZUtleSwgdGFyZ2V0W2tleV0pO1xuICAgICAgICAgICAgdHJpZ2dlckNoYW5nZShldik7XG4gICAgICAgICAgfSk7XG4gICAgICAgICAgY3VycmVudENvbnRyb2xzLnB1c2goZ3VpQ29udHJvbCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgLy8gTm90IGF1dG8tZGV0ZWN0ZWQsIG1heWJlIGEgcmVndWxhciBvYmplY3Qgb3JcbiAgICAgICAgICAvLyBzb21ldGhpbmcgdGhhdCBzaG91bGRuJ3QgYmUgYWRkZWQgdG8gR1VJXG4gICAgICAgICAgdGFyZ2V0W2tleV0gPSB2YWx1ZTtcblxuICAgICAgICAgIC8vIGFsc28gYWRkIHRvIGNvbnRyb2xzIGlmIGl0J3MgYW4gb2JqZWN0LCB0byBtYWtlIGEgdHJlZVxuICAgICAgICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmIHZhbHVlICYmIHZhbHVlLmNvbnRyb2xzKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHZhbHVlLmNvbnRyb2xzLm9uICE9PSAnZnVuY3Rpb24nKSB7XG4gICAgICAgICAgICAgIHRocm93IG5ldyBFcnJvcignVGhlIHsgY29udHJvbHMgfSBmaWVsZCBpcyBhIHJlc2VydmVkIHdvcmQgZm9yIHRoZSBHVUksIGl0IHNob3VsZCBwb2ludCB0byBhIFVJIGNvbnRyb2wgbWFwcGluZycpO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY29udHJvbHNba2V5XSA9IHZhbHVlLmNvbnRyb2xzO1xuICAgICAgICAgICAgdmFsdWUuY29udHJvbHNcbiAgICAgICAgICAgICAgLm9uKCdjaGFuZ2UnLCB0cmlnZ2VyQ2hhbmdlKTtcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgIH0gZWxzZSBpZiAodmFsdWUgJiYgdmFsdWUuaXNDb250cm9sKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcignUmUtYXNzaWduaW5nIHZhbHVlcyB0byBhIG5ldyBjb250cm9sIGlzIG5vdCB5ZXQgc3VwcG9ydGVkJyk7XG4gICAgICB9IGVsc2Uge1xuICAgICAgICAvLyBHVUkgYmVpbmcgbWFudWFsbHkgbXV0YXRlZFxuICAgICAgICB0YXJnZXRba2V5XSA9IHZhbHVlO1xuICAgICAgICBpZiAoa2V5IGluIGNvbnRyb2xzKSB7XG4gICAgICAgICAgY29udHJvbHNba2V5XS51cGRhdGVEaXNwbGF5KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICAgIHJldHVybiB0cnVlO1xuICAgIH0sXG4gICAgZ2V0ICh0YXJnZXQsIGtleSkge1xuICAgICAgaWYgKGtleSA9PT0gJ2NvbnRyb2xzJykgcmV0dXJuIGNvbnRyb2xzO1xuICAgICAgY29uc3QgcmVzdWx0ID0gdGFyZ2V0W2tleV07XG4gICAgICByZXR1cm4gcmVzdWx0O1xuICAgIH1cbiAgfSk7XG4gIE9iamVjdC5hc3NpZ24ocHJveHksIG9wdCk7XG4gIGlmICh0eXBlb2YgY2IgPT09ICdmdW5jdGlvbicpIHtcbiAgICBjb25zdCB1cGRhdGUgPSAoKSA9PiBjYihvYmopO1xuICAgIGNvbnRyb2xzLm9uKCdjaGFuZ2UnLCB1cGRhdGUpO1xuICB9XG4gIHJldHVybiBwcm94eTtcbn1cblxuZnVuY3Rpb24gZ2V0R1VJUGF0aCAoZ3VpKSB7XG4gIGxldCBuYW1lID0gZ3VpLm5hbWUgfHwgJ3Jvb3QnO1xuICB3aGlsZSAoZ3VpKSB7XG4gICAgZ3VpID0gZ3VpLnBhcmVudDtcbiAgICBpZiAoZ3VpKSBuYW1lID0gYCR7Z3VpLm5hbWUgfHwgJ3Jvb3QnfS4ke25hbWV9YDtcbiAgfVxuICByZXR1cm4gbmFtZTtcbn1cblxuZnVuY3Rpb24gcHV0TG9jYWxTdG9yYWdlIChjdXJyZW50Q29udHJvbCwga2V5LCB2YWx1ZSkge1xuICBpZiAoSlNPTi5zdHJpbmdpZnkodmFsdWUpKSB7XG4gICAgc3RvcmVba2V5XSA9IHsgdmFsdWUsIHR5cGU6IGN1cnJlbnRDb250cm9sLnR5cGUsIGRlZmF1bHRWYWx1ZTogY3VycmVudENvbnRyb2wudmFsdWUgfTtcbiAgICB3cml0ZUxvY2FsU3RvcmFnZSgpO1xuICB9XG59XG5cbmZ1bmN0aW9uIGdldExvY2FsU3RvcmFnZSAoY3VycmVudENvbnRyb2wsIGtleSkge1xuICBpZiAoa2V5IGluIHN0b3JlKSB7XG4gICAgY29uc3Qgc3RvcmVkID0gc3RvcmVba2V5XTtcbiAgICBpZiAoIXN0b3JlZCkgcmV0dXJuIHVuZGVmaW5lZDtcbiAgICBpZiAoY3VycmVudENvbnRyb2wudHlwZSAhPT0gc3RvcmVkLnR5cGUpIHJldHVybiB1bmRlZmluZWQ7XG4gICAgaWYgKGN1cnJlbnRDb250cm9sLnZhbHVlICE9PSBzdG9yZWQuZGVmYXVsdFZhbHVlKSByZXR1cm4gdW5kZWZpbmVkO1xuICAgIC8vIGNvbnNvbGUubG9nKCdDSEVDSyBDSEVDSycsIGtleSwgY3VycmVudENvbnRyb2wudmFsdWUsIHN0b3JlZC5kZWZhdWx0VmFsdWUpXG4gICAgcmV0dXJuIHN0b3JlZC52YWx1ZTtcbiAgfVxuICByZXR1cm4gdW5kZWZpbmVkO1xufVxuXG5mdW5jdGlvbiByZWFkTG9jYWxTdG9yYWdlICgpIHtcbiAgLy8gUGFyc2UgbmV3IHN0b3JlLCB1c3VhbGx5IGp1c3QgaGFwcGVucyBhdCBzdGFydHVwXG4gIHRyeSB7XG4gICAgY29uc3Qgc3RyID0gd2luZG93LmxvY2FsU3RvcmFnZS5nZXRJdGVtKExPQ0FMX1NUT1JBR0VfS0VZKTtcbiAgICBpZiAoc3RyID09IG51bGwpIHtcbiAgICAgIC8vIE5vIHN0b3JhZ2UgeWV0IGlkZW50aWZpZWQsIG5vIG5lZWQgdG8ga2VlcCBhbnl0aGluZyBhcm91bmQgeWV0XG4gICAgICBjbGVhclN0b3JhZ2UoKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgY29uc3QgbmV3U3RvcmUgPSBKU09OLnBhcnNlKHN0cik7XG4gICAgc3RvcmUgPSBuZXdTdG9yZTsgLy8gYXNzaWduIG5ldyBzdG9yZVxuICB9IGNhdGNoIChlcnIpIHtcbiAgICBjb25zb2xlLndhcm4oYFRoZSBsb2NhbFN0b3JhZ2UgYXQgJHtMT0NBTF9TVE9SQUdFX0tFWX0gY291bGQgbm90IGJlIHBhcnNlZCBkdWUgdG8gYSBKU09OIGVycm9yLmApO1xuICAgIGNvbnNvbGUud2FybihlcnIpO1xuICAgIC8vIENsZWFyIHRoZSBlcnJvciBzbyBpdCBkb2Vzbid0IGtlZXAgcG9sbHV0aW5nIGxvZ3NcbiAgICBjbGVhclN0b3JhZ2UoKTtcbiAgfVxufVxuXG5mdW5jdGlvbiBjbGVhclN0b3JhZ2UgKCkge1xuICB3aW5kb3cubG9jYWxTdG9yYWdlLnJlbW92ZUl0ZW0oTE9DQUxfU1RPUkFHRV9LRVkpO1xuICBzdG9yZSA9IHt9O1xufVxuXG5mdW5jdGlvbiByZXNldCAoKSB7XG4gIGNsZWFyU3RvcmFnZSgpO1xuICBjdXJyZW50Q29udHJvbHMuZm9yRWFjaChjb250cm9sID0+IHtcbiAgICBjb250cm9sLnJlc2V0KCk7XG4gIH0pO1xufVxuXG5mdW5jdGlvbiB3cml0ZUxvY2FsU3RvcmFnZSAoKSB7XG4gIGNvbnN0IHN0ciA9IEpTT04uc3RyaW5naWZ5KHN0b3JlKTtcbiAgaWYgKHN0ciA9PSBudWxsKSB7XG4gICAgY29uc29sZS53YXJuKCdUaGUgc3RvcmFnZSBjb3VsZCBub3QgYmUgc3RyaW5naWZpZWQgYXMgSlNPTiwgc2tpcHBpbmcgbG9jYWxTdG9yYWdlJyk7XG4gICAgcmV0dXJuO1xuICB9XG4gIHdpbmRvdy5sb2NhbFN0b3JhZ2Uuc2V0SXRlbShMT0NBTF9TVE9SQUdFX0tFWSwgc3RyKTtcbn1cblxuZnVuY3Rpb24gQ29udHJvbHMgKG9wdHMgPSB7fSwgY2IpIHtcbiAgcmV0dXJuIGNyZWF0ZUNvbnRyb2xzKG9wdHMsIGNiLCAncm9vdCcsIGd1aSk7XG59XG5cbmZ1bmN0aW9uIEZvbGRlciAobGFiZWwsIG9wdHMgPSB7fSwgY2IpIHtcbiAgaWYgKCFsYWJlbCkgdGhyb3cgbmV3IEVycm9yKCdNdXN0IHNwZWNpZnkgYSBsYWJlbCBmb3IgRm9sZGVyKCknKTtcbiAgY29uc3QgZm9sZGVyID0gZ3VpLmFkZEZvbGRlcihsYWJlbCk7XG4gIGZvbGRlci5vcGVuKCk7XG4gIHJldHVybiBjcmVhdGVDb250cm9scyhvcHRzLCBjYiwgbGFiZWwsIGZvbGRlcik7XG59XG5cbk9iamVjdC5hc3NpZ24oQ29udHJvbHMsIHtcbiAgcGFyZW50LFxuICBudW1iZXI6IE51bWJlcklucHV0LFxuICBzdHJpbmc6IFN0cmluZ0lucHV0LFxuICBzbGlkZXI6IFNsaWRlcixcbiAgc2VsZWN0OiBTZWxlY3QsXG4gIGNoZWNrYm94OiBDaGVja2JveCxcbiAgYnV0dG9uOiBCdXR0b24sXG4gIGZvbGRlcjogRm9sZGVyLFxuICBjb2xvcjogQ29sb3IsXG4gIHZhbHVlOiBWYWx1ZSxcbiAgY2xlYXJTdG9yYWdlLFxuICByZXNldCxcblxuICAvLyBEZXByZWNhdGVkXG4gIFNsaWRlcixcbiAgTnVtYmVyLFxuICBTZWxlY3QsXG4gIEJ1dHRvbixcbiAgQ2hlY2tib3gsXG4gIEZvbGRlcixcbiAgQ29sb3IsXG4gIFZhbHVlXG59KTtcblxubW9kdWxlLmV4cG9ydHMgPSBDb250cm9scztcbiJdLCJuYW1lcyI6WyJjb25zdCIsImxldCJdLCJtYXBwaW5ncyI6IkFBQUE7Ozs7QUFJQUEsR0FBSyxDQUFDLEdBQUcsR0FBRyxPQUFPLENBQUMsU0FBUyxDQUFDLENBQUMsR0FBRyxDQUFDO0FBQ25DQSxHQUFLLENBQUMsT0FBTyxHQUFHLE9BQU8sQ0FBQyxTQUFTLENBQUMsQ0FBQztBQUNuQ0EsR0FBSyxDQUFDLFVBQVUsR0FBRyxPQUFPLENBQUMsYUFBYSxDQUFDLENBQUM7QUFDMUMsT0FBc0IsR0FBRyxPQUFPLENBQUMsUUFBUTtBQUFqQyxvQ0FBbUM7O0FBRTNDQSxHQUFLLENBQUMsR0FBRyxHQUFHLElBQUksR0FBRyxFQUFFLENBQUM7QUFDdEJBLEdBQUssQ0FBQyxRQUFRLEdBQUcsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUM7QUFDMUNBLEdBQUssQ0FBQyxpQkFBaUIsR0FBRyxDQUFHLFFBQVEsSUFBSSxXQUFVLFNBQU0sQ0FBQztBQUMxREEsR0FBSyxDQUFDLE1BQU0sR0FBRyxRQUFRLENBQUMsYUFBYSxDQUFDLFFBQVEsQ0FBQyxDQUFDOztBQUVoREMsR0FBRyxDQUFDLEtBQUssR0FBRyxFQUFFLENBQUM7QUFDZkEsR0FBRyxDQUFDLGVBQWUsR0FBRyxFQUFFLENBQUM7O0FBRXpCLElBQUksTUFBTSxFQUFFO0VBQ1ZELEdBQUssQ0FBQyxLQUFLLEdBQUcsUUFBUSxDQUFDLGFBQWEsQ0FBQyxVQUFVLENBQUMsQ0FBQztFQUNqRCxJQUFJLEtBQUssSUFBRSxLQUFLLENBQUMsS0FBSyxDQUFDLE1BQU0sR0FBRyxHQUFHLEdBQUM7RUFDcEMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsS0FBSyxFQUFFO0lBQzFCLEtBQUssRUFBRSxNQUFNO0lBQ2IsTUFBTSxFQUFFLE1BQU07SUFDZCxPQUFP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